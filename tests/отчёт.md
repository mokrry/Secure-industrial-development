# Отчёт по соответствию ТМ 0.15 (проект: [https://github.com/mokrry/course-project-mokrry](https://github.com/mokrry/course-project-mokrry))

## 1) Что уже есть

**Код и архитектура**

- FastAPI + SQLAlchemy + Pydantic v2; слои: `api → services → repositories → models → schemas`.
    
- REST-методы (≥5):  
    `GET /api/v1/topics`, `GET /api/v1/topics/{id}`, `POST /api/v1/topics`, `PUT /api/v1/topics/{id}`, `GET /api/v1/topics?status=…`.
    
- Валидация входа (длины, enum `status`), централизованный JSON-конверт ошибок.
    
- Тесты `pytest` (4 passed); исправлена блокировка SQLite на Windows.
    

**Процесс**

- Работа ведётся в фиче-ветках, PR в `main`.
    
- GitHub Actions: линт/формат (`ruff/black/isort`), тесты; проверки проходят.
    
- Branch protection для `main`: запрет прямых пушей, required checks — настроено/готово к включению.
    

**Безопасное кодирование**

- Ввод валидируется, ORM вместо сырого SQL (снижение риска SQLi), корректные коды 4xx.
    

---

## 2) Соответствие критериям ТМ

|Критерий|Статус|Комментарий|
|---|---|---|
|NFR ≥ 8 с критериями приёма|❌|Нужен документ с нефункциональными требованиями безопасности.|
|3–4 DFD с границами доверия|❌|Нужны диаграммы DFD + trust boundaries.|
|STRIDE ≥ 8 угроз|❌|Нужен реестр угроз.|
|Меры с трассировкой к угрозам/историям|⚠️|Частично покрыто кодом (валидация, ORM), нужен сформальный реестр и трассировка.|
|Приоритизация/оформление|❌|Нужны таблицы приоритетов/рисков и аккуратное оформление.|

**Результаты обучения:**

- NFR и моделирование угроз — ❌ (требуются документы).
    
- Базовый DevOps-процесс — ✅ (ветки, PR, CI, required checks).
    
- Безопасное кодирование — ✅ (база: валидация, ORM, ошибки; AuthN/AuthZ пока нет).
    
- Автоматизация DevSecOps-контролей — ⚠️ (добавить secret/dependency/SAST/DAST в CI).
    
- Контейнер/инфра hardening — ❌ (нужны Dockerfile, Trivy, non-root и т.д.).
    
- Наблюдаемость/реагирование — ❌ (структурные логи, базовые правила).
    

---

## 3) Рекомендованные шаги, чтобы добрать требования

### A. Документация по безопасности

Добавить в `docs/`:

- `security-requirements.md` — **≥8 NFR** с измеримыми критериями приёма (validation, error handling, rate limiting, authn/authz, logging, availability, secrets mgmt, privacy/retention, backup/DR).
    
- `dfd/` — 3–4 DFD с trust boundaries (клиент ↔ API, API ↔ DB, внешние сервисы). Можно mermaid/draw.io.
    
- `threat-model.md` — **STRIDE ≥8**: таблица «Угроза → Компонент → Последствия → Меры (превентивные/детективные) → Ссылки на код/CI → Приоритет/остаточный риск».
    
- Отдельная таблица **приоритизации** (severity × likelihood) и статус внедрения мер.
    

### B. DevSecOps-контроли в CI

- **Dependency scan**: `pip-audit` (и/или SBOM c `cyclonedx-py`).
    
- **Secret scan**: `gitleaks` или `trufflehog`.
    
- **SAST**: `bandit` (или расширенные security-правила ruff).
    
- **DAST (baseline)**: OWASP ZAP baseline action против поднятого API.
    
- Отметить эти джобы как **required checks**.
    

### C. Контейнеризация и hardening

- `Dockerfile` (multi-stage, `python:3.12-slim`), `USER` non-root, минимизация слоя, healthcheck.
    
- `docker-compose.yml` (API + SQLite/Postgres).
    
- Trivy job для image scan (fail на High/Critical).
    

### D. Наблюдаемость

- Структурные логи (JSON), `request_id`/корреляция, базовые правила инцидентов (описать в `docs/ops/`).
    

### E. Бонус-функционал (не обязательно, но усиливает отчёт)

- Пагинация/сортировка для `/topics`.
    
- Покрытие `pytest-cov` + выгрузка coverage в артефакты CI.
    
- `CODEOWNERS` и требование review от code owners.
    

---

## 4) Что уже можно указать в PR

- Ссылки на `/docs` (Swagger), на CI-проверки в PR, на Issue с формулировкой задачи.
    
- Краткая карта веток и принятая модель ветвления.
    
- Чек-лист: «линты, тесты, CI — зелёные; ветка `main` защищена; REST-методы работают».